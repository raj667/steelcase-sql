# Customer-Segment

# To analyze customer percentage from each state

with cte1 as(
SELECT 
    c.state, COUNT(c.Customer_ID) AS Customer_Count
FROM
    master_customer c
        LEFT JOIN
    store_data sd USING (customer_id)
        LEFT JOIN
    master_product p ON sd.product_id = p.ï»¿Product_ID
GROUP BY 1
ORDER BY 2 DESC),

cte2 as (select sum(customer_count) as customer_sum from cte1),

cte3 as (select * from cte1 left join cte2 on cte1.customer_count<cte2.customer_sum)

select state, customer_count, round((customer_count/customer_sum)*100,2) as Customer_Percentage from cte3;

