# Customer-Segment

# To Analyze Customer Percentage From Each State

with cte1 as(
SELECT 
    c.state, COUNT(c.Customer_ID) AS Customer_Each_State
FROM
    master_customer c
        LEFT JOIN
    store_data sd USING (customer_id)
        LEFT JOIN
    master_product p ON sd.product_id = p.ï»¿Product_ID
GROUP BY 1
ORDER BY 2 DESC),

cte2 as (select sum(customer_each_state) as total_customer from cte1),

cte3 as (select * from cte1 left join cte2 on cte1.customer_each_state<cte2.total_customer)

select state, customer_each_state, round((customer_each_state/total_customer)*100,2) as Customer_Percentage from cte3;

